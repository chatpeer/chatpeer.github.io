import{q as e,r as t}from"./vendor.1c3334d4.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(n){const o=new URL(e,location),s=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((n,c)=>{const r=new URL(e,o);if(self[t].moduleMap[r])return n(self[t].moduleMap[r]);const i=new Blob([`import * as m from '${r}';`,`${t}.moduleMap['${r}']=m;`],{type:"text/javascript"}),u=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(i),onerror(){c(new Error(`Failed to import: ${e}`)),s(u)},onload(){n(self[t].moduleMap[r]),s(u)}});document.head.appendChild(u)})),self[t].moduleMap={}}}("/assets/");class n{constructor(){const e=this;if(e.constructor.instance)return e.constructor.instance;e.connections=[],e.peer=new Peer(null,{pingInterval:3e3,debug:1,config:{iceServers:[{url:"stun:stun01.sipphone.com"},{url:"stun:stun.ekiga.net"},{url:"stun:stun.fwdnet.net"},{url:"stun:stun.ideasip.com"},{url:"stun:stun.iptel.org"},{url:"stun:stun.rixtelecom.se"},{url:"stun:stun.schlund.de"},{url:"stun:stun.l.google.com:19302"},{url:"stun:stun1.l.google.com:19302"},{url:"stun:stun2.l.google.com:19302"},{url:"stun:stun3.l.google.com:19302"},{url:"stun:stun4.l.google.com:19302"},{url:"stun:stunserver.org"},{url:"stun:stun.softjoys.com"},{url:"stun:stun.voiparound.com"},{url:"stun:stun.voipbuster.com"},{url:"stun:stun.voipstunt.com"},{url:"stun:stun.voxgratia.org"},{url:"stun:stun.xten.com"}]}}),e.peer.on("disconnected",(function(t){console.log("-- Reconnect --"),e.peer._id=t,e.peer._lastServerId=t,e.peer.reconnect()})),e.peer.on("error",(function(e){console.log(e)})),e.peer.on("connection",(function(t){return e.handleConnection(t)})),e.constructor.instance=this}getConnect(e){const t=this.peer.connect(e);return this.handleConnection(t)}handleConnection(e){const t=this;return e.on("open",(function(n){return console.log("Connected with peer: "+e.peer),document.dispatchEvent(new CustomEvent("peerConnected",{detail:{peer:e.peer,content:"Connected with peer: "+e.peer}})),e.on("data",(function(t){document.dispatchEvent(new CustomEvent("peerReceiveData",{detail:{peer:e.peer,content:t}}))})),e.on("error",(function(e){console.log(e),document.dispatchEvent(new CustomEvent("peerError",{detail:{error:e.message}}))})),t.connections.push(e),e}))}broadcastMessage(e){for(let t=0;t<this.connections.length;t++)this.connections[t].send(e)}privateMessage(e,t){for(let n=0;n<this.connections.length;n++)if(this.connections[n].peer==e){this.connections[n].send(t);break}}}window._cb=function(){return{way:null,qrurl:"",qrbox:!1,chatbox:!1,userbox:!0,chatlist:[],chatfocus:{list:[]},chatinput:"",_cb_init(){const o=this;o.way=new n,o.way.peer.on("open",(function(t){console.log("My peer ID is: "+t);const n=location.protocol+"//"+location.hostname+(location.port?":"+location.port:"");o.qrurl=n+"?peer="+t,new e({element:document.querySelector("#qrchat"),size:120,value:o.qrurl});const s=(c="peer",decodeURIComponent(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+encodeURIComponent(c).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1")));var c;s&&o.way.getConnect(s)})),document.addEventListener("peerReceiveData",(async function(e){const t=e.detail||{};console.log(t);let n=o._cb_chatlist_find(t.peer,!0);n&&n.list.push(t)})),document.addEventListener("peerConnected",(async function(e){const t=e.detail||{};let n=o.chatlist.findIndex((e=>e.peer===t.peer));o.way.peer.id!==t.peer&&-1===n&&o.chatlist.push({peer:t.peer,username:"no name",list:[]})}));const s=new t,c=o.$refs["emoji-btn"];c&&(s.on("emoji",(e=>{o.chatinput+=" "+e.emoji;const t=o.$refs.message;t&&o.$nextTick((()=>{t.focus()}))})),c.addEventListener("click",(()=>s.togglePicker(c))))},_cb_chatlist_find(e,t=!1){let n=this.chatlist.find((t=>t.peer===e));return n&&!n.list&&(n.list=[]),n.notify=t,n},_cb_click(e){const t=this;if(t.chatfocus.peer===e)t.chatbox=!t.chatbox,t.chatfocus={list:[]};else{let n=t._cb_chatlist_find(e);t.chatfocus=n,t._cb_main_bottom(),t.chatbox=!0,t.qrbox=!1}},_cb_send(){const e=this;let t={peer:e.chatfocus.peer,content:e.chatinput,me:!0};e.way.privateMessage(t.peer,t.content);let n=e._cb_chatlist_find(t.peer);n&&n.list.push(t),e.chatfocus=n,e.chatinput="",e._cb_main_bottom()},_cb_main_bottom(){const e=this.$refs["chat-main"];e&&this.$nextTick((()=>{e.scrollTop=e.scrollHeight}))},_cb_user:{"@click"(e){this.userbox=!this.userbox},"@keydown.escape"(){this.userbox=!1}},_cb_user_main:{"@keydown.escape"(){this.userbox=!1},"x-show.transition"(){return this.userbox}},_cb_qrbox(){this.qrbox=!0,this.chatfocus.peer?this.chatfocus={list:[]}:this.chatbox=!this.chatbox},_cb_copy(){(function(e){if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(e);{let t=document.createElement("textarea");return t.value=e,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select(),new Promise(((e,n)=>{document.execCommand("copy")?e():n(),t.remove()}))}})(this.qrurl).then((()=>console.log("text copied !"))).catch((()=>console.log("error")))}}};window._dd=function(){return{dropdown:!1,_dd_trigger:{"@keydown.escape"(){this.open=!1},"@click"(){this.open=!0}},_dd_main:{"@keydown.escape"(){this.open=!1},"x-show.transition"(){return this.open},"@click.away"(){this.open=!1}}}},window._sb=function(){return{dark:"true"===localStorage.getItem("dark"),sidebar:"true"===localStorage.getItem("sidebar"),_sb_init(){const e=this;e.$watch("dark",(e=>{localStorage.setItem("dark",e)})),e.$watch("sidebar",(e=>{localStorage.setItem("sidebar",e)})),window.onresize=function(e,t){let n;return function(){clearTimeout(n),n=setTimeout((()=>e.apply(this,arguments)),t)}}((function(){window.innerWidth<768?e.sidebar=!1:e.sidebar=!0}),300)}}},window._sm=function(){return{sidemenu:"true"===localStorage.getItem("sidemenu"),_sm_close:{"@click"(){this.sidemenu=!1}},_sm_trigger:{"@keydown.escape"(){this.sidemenu=!1},"@click"(){this.sidemenu=!0}},_sm_node:{"@keydown.escape"(){this.sidemenu=!1},"x-show"(){return this.sidemenu},"@click.away"(){this.sidemenu=!1}},_init(){this.$watch("sidemenu",(e=>{localStorage.setItem("sidemenu",e)}))}}};
